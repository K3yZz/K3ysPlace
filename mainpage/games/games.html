<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Games - K3yz Place</title>
    <link rel="stylesheet" href="games.css" />
    <meta
      name="description"
      content="Play unported, ported, and emulator games at K3yz Place."
    />
  </head>

  <body>
    <div id="menuContainer" class="blur">
      <button
        class="menuButton secondary"
        id="Home"
        onclick="window.location.href='index.html'"
      >
        Home
      </button>
      <button
        class="menuButton secondary"
        id="Games"
        onclick="window.location.href='mainpage/games/games.html'"
      >
        Games
      </button>
      <button
        class="menuButton secondary"
        id="Apps"
        onclick="window.location.href='mainpage/apps/apps.html'"
      >
        Apps
      </button>
      <button
        class="menuButton secondary"
        id="Settings"
        onclick="window.location.href='mainpage/settings/settings.html'"
      >
        Settings
      </button>
    </div>

    <div class="switch-container">
      <div class="three-way-switch blur">
        <input type="radio" name="gameSwitch" id="unported" checked/>
        <input type="radio" name="gameSwitch" id="ported"/>
        <input type="radio" name="gameSwitch" id="emulator" />

        <label for="unported"></label>
        <label for="ported"></label>
        <label for="emulator"></label>

        <div class="slider"></div>
      </div>
    </div>

    <div class="gameContainer" id="notportedContent"></div>
    <div class="gameContainer" id="portedContent"></div>
    <div class="gameContainer" id="emulatorsContent"></div>

    <script type="module">
      const containers = {
        unported: document.getElementById("notportedContent"),
        ported: document.getElementById("portedContent"),
        emulator: document.getElementById("emulatorsContent"),
      };

      const unportedRadio = document.getElementById("unported");
      const portedRadio = document.getElementById("ported");
      const emulatorRadio = document.getElementById("emulator");
      const radioButtons = [unportedRadio, portedRadio, emulatorRadio];
      const slider = document.querySelector(".slider");

      function updateGameView() {
        containers.unported.style.display = unportedRadio.checked ? "flex" : "none";
        containers.ported.style.display = portedRadio.checked ? "flex" : "none";
        containers.emulator.style.display = emulatorRadio.checked ? "flex" : "none";

        const index = radioButtons.findIndex((r) => r.checked);
        slider.style.transform = `translateX(${index * 35}px)`;
      }

      radioButtons.forEach((radio) =>
        radio.addEventListener("change", updateGameView)
      );
      updateGameView();

      async function loadGames() {
        try {
          const res = await fetch("games.json");
          const data = await res.json();

          for (const category in data) {
            if (!containers[category]) continue;

            data[category].forEach((game) => {
              const btn = document.createElement("div");
              btn.classList.add("game-button", "blur");

              const href = game.link || game.href;
              btn.dataset.href = href;

              const img = document.createElement("img");
              img.src = game.icon;
              btn.appendChild(img);

              const title = document.createElement("span");
              title.classList.add("title");
              title.textContent = game.title;
              btn.appendChild(title);

              containers[category].appendChild(btn);

              btn.addEventListener("click", () => {
                if (href && href !== "#") window.location.href = href;
              });
            });
          }
        } catch (err) {
          console.error("Failed to load games:", err);
        }
      }

      loadGames();
    </script>

    <script type="module" src="../../loader.js"></script>
  </body>
</html>
